<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/docs/4.0/assets/img/favicons/favicon.ico">
    <link rel="canonical" href="https://getbootstrap.com/docs/4.0/examples/product/">

    <!-- Bootstrap core CSS -->
    <link href="{{url_for('static',filename='bootstrap.min.css')}}" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/config.css') }}">
    <link href="{{url_for('static', filename='main.css')}}" rel="stylesheet">
    <link href="{{url_for('static', filename='css/config.css')}}" rel="stylesheet">

    <script src="{{url_for('static', filename='js/config.js')}}"></script>


    {% extends "base.html" %}

    {% block title %}
      Configuration
    {% endblock %}

  </head>

  {% block content %}


    <div class="jumbotron p-3 p-md-5 text-white rounded bg-dark">
      <center>
        <div class="col-md-6 px-0">
          <h1 class="display-3">Configure Your Flight Plan</h1>
          <p class="lead my-3">Insert instructions for the user to follow on this page</p>
          <p>
            <button type="button" class="btn btn-primary my-2" onclick="validate_flight_plan()">Validate</button>
            <button type="button" class="btn btn-primary my-2" onclick="submit_flight_plan()">Submit</button>
          </p>
        </div>
      </div>
  </center>

  <body>
<style>
  * {
    box-sizing: border-box;
  }

  /* Create three equal columns that float next to each other */
  .row {
    display: flex;
    flex-wrap: wrap;
  }

  .column {
    flex: 1;
    padding: 10px;
    width: 33.33%;
  }

  /* Ensure that each column has a minimum height */
  #flight-plan-column,
  #drop-locations-column,
  #examples-column {
    min-height: 500px; /* Minimum height to prevent overlap with footer */
  }

  /* Clear floats after the columns */
  .row:after {
    content: "";
    display: table;
    clear: both;
  }
</style>

</style>
 <div class="column" style="background-color:#ffffff;">
    <center>
      <h2>Define Drop Locations</h2>
      <br>


      <p>How many drop off locations do you want to configure?</p>
      <input type="number" id="num-drop-locations" min="1" max="4">
      <br><br>
      <button type="button" class="btn btn-primary my-2" onclick="configure_drop_locations()">Generate table</button>
      <table id="drop-locations-table" class="table table-striped" style="display: none;">

  <tbody>
    <!-- Rows will be dynamically generated with JavaScript -->
  </tbody>
</table>

      <div class="submit-button">
  <button type="button" class="btn btn-primary my-2" onclick="submit_drop_locations()">Submit</button>
</div>

    </center>
    <script>
function configure_drop_locations() {
  var num_drop_locations = document.getElementById("num-drop-locations").value;
  var table = document.getElementById("drop-locations-table");
  var tbody = table.getElementsByTagName("tbody")[0];
  tbody.innerHTML = "";

  // Add header row
  var header_row = document.createElement("tr");
  var location_num_header = document.createElement("th");
  location_num_header.innerHTML = "Location Number";
  header_row.appendChild(location_num_header);
  var alias_header = document.createElement("th");
  alias_header.innerHTML = "Alias";
  header_row.appendChild(alias_header);
  var mission_pad_num_header = document.createElement("th");
  mission_pad_num_header.innerHTML = "Mission Pad Number";
  header_row.appendChild(mission_pad_num_header);
  var coords_header = document.createElement("th");
  coords_header.innerHTML = "Coordinates";
  header_row.appendChild(coords_header);
  tbody.appendChild(header_row);

  // Add rows
  for (var i = 0; i < num_drop_locations; i++) {
    var row = document.createElement("tr");

    // Location number cell
    var location_num_cell = document.createElement("td");
    location_num_cell.innerHTML = i + 1;
    row.appendChild(location_num_cell);

    // Alias cell
    var alias_cell = document.createElement("td");
    var alias_input = document.createElement("input");
    alias_input.type = "text";
    alias_input.name = "alias-" + (i+1);
    alias_input.id = "alias-" + (i+1);
    alias_input.value = "Drop Location " + (i + 1); // Set default value
    alias_cell.appendChild(alias_input);
    row.appendChild(alias_cell);

    // Mission pad number cell
    var mission_pad_num_cell = document.createElement("td");
    var mission_pad_num_input = document.createElement("input");
    mission_pad_num_input.type = "text";
    mission_pad_num_input.name = "mission-pad-num-" + (i+1);
    mission_pad_num_input.id = "mission-pad-num-" + (i+1);
    mission_pad_num_input.value = i + 1; // Set default value as integer
    mission_pad_num_cell.appendChild(mission_pad_num_input);
    row.appendChild(mission_pad_num_cell);

    // Coordinates cell
    var coords_cell = document.createElement("td");
    var coords_button = document.createElement("button");
    coords_button.innerHTML = "Get Drone Coordinates";
    coords_button.id = "coords-button-" + (i+1);
    coords_button.setAttribute("onclick", "get_drone_coords(" + (i+1) + ")");
    coords_cell.appendChild(coords_button);
    row.appendChild(coords_cell);

    tbody.appendChild(row);
  }

  // Show table
  table.style.display = "block";
}


function get_drone_coords(location_num) {
  var button = document.getElementById("coords-button-" + location_num);
  button.innerHTML = "Loading...";
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState === 4 && xhr.status === 200) {
      button.innerHTML = xhr.responseText;
    }
  }
  xhr.open("GET", "/get_drone_coords", true);
  xhr.send();
}


function submit_drop_locations() {
  var data = [];
  var table = document.getElementById("drop-locations-table");
  var tbody = table.getElementsByTagName("tbody")[0];
  if (!tbody) {
    // handle the case where there is no tbody element
    return;
  }
  var rows = tbody.getElementsByTagName("tr");
  if (rows.length === 0) {
    // handle the case where there are no rows in the tbody element
    return;
  }

  for (var i = 1; i < rows.length; i++) {
    var row = rows[i];
    var alias = row.getElementsByTagName("input")[0].value;
    var mission_pad = row.getElementsByTagName("input")[1].value;
    var coords = row.getElementsByTagName("button")[0].innerText;
    data.push({
      "alias": alias,
      "mission_pad": mission_pad,
      "coords": coords
    });
  }

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/submit_drop_locations", true);
  xhr.setRequestHeader("Content-Type", "application/json");
  xhr.send(JSON.stringify(data));
}




</script>

  </div>

  <div class="column" style="background-color:#ffffff;">
    <center>
      <h3> Enter Flight Plan Below:</h3>
      <textarea id= "fplanfield" rows = "10" cols = "60" id= "fplan"></textarea>
    </center>
      <script>
        function validate_flight_plan(){
          var fplan = document.getElementById("fplanfield").value;
          var xhr = new XMLHttpRequest();
          xhr.open("POST", "/validate_flight_plan", true);
          xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          xhr.send("fplanfield=" + encodeURIComponent(fplan));
        }
      </script>

    <script>
        function submit_flight_plan(){
          var fplan = document.getElementById("fplanfield").value;
          var xhr = new XMLHttpRequest();
          xhr.open("POST", "/submit_flight_plan", true);
          xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          xhr.send("fplanfield=" + encodeURIComponent(fplan));
        }
      </script>
  </div>
  <div class="column" style="background-color:#ffffff;">
    <center>
      <h2>Examples</h2>
      <br>
      <p1> Drone Instructions are precceded by '*'</p1> <br>
      <p1> Drone Examples: '* pickup food_#' or '* drop food_#'</p1> <br>

      <br> <br>

      <p1> Location instructions are delimited by '->'</p1> <br>
      <p1> Location Examples: 'Home->A' or 'A->B' </p1>


    </center>

  </div>
</div>

</body>


  <center>






    </center>
    {% endblock %}


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="{{url_for('static',filename='popper.min.js')}}"></script>
    <script src="{{url_for('static',filename='bootstrap.min.js')}}"></script>
    <script src=".{{url_for('static',filename='holder.min.js')}}"></script>
    <script>
      Holder.addTheme('thumb', {
        bg: '#55595c',
        fg: '#eceeef',
        text: 'Thumbnail'
      });
    </script>
  </body>




</html>
